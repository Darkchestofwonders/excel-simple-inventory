{"version":"0.3.0","body":"function main(workbook: ExcelScript.Workbook) {\n    // Get the 'Client Form' and 'Database' sheets\n    const formSheet = workbook.getWorksheet(\"Product Form\");\n    const databaseSheet = workbook.getWorksheet(\"Database & Calc\");\n\n    // Get the customer name from cell H7\n    const prodName = formSheet.getRange(\"H5\").getValue() as string;\n\n    if (!prodName) {\n        throw new Error(\"Please enter a Product and 'Find'\");\n    }\n\n    // Get the 'ClientData' table\n    const custTable = databaseSheet.getTable(\"ProductData\");\n    const tableBodyRange = custTable.getRangeBetweenHeaderAndTotal();\n    const tableData = tableBodyRange.getValues();\n\n    // Get headers and find the index of \"Full Name\" and \"Deleted\"\n    const headers = custTable.getHeaderRowRange().getValues()[0];\n    const custNameIndex = headers.indexOf(\"Product #\");\n    const deletedIndex = headers.indexOf(\"Deleted\");\n\n    if (custNameIndex === -1) {\n        throw new Error(\"'Customer' column not found in the table.\");\n    }\n\n    if (deletedIndex === -1) {\n        throw new Error(\"'Deleted' column not found in the table.\");\n    }\n\n    // Search for the row and set 'Deleted' to 'Yes' if found\n    for (let i = 0; i < tableData.length; i++) {\n        const row = tableData[i];\n        const existingName = row[custNameIndex]?.toString().trim().toLowerCase();\n        if (existingName === prodName.trim().toLowerCase()) {\n            // Set the \"Deleted\" column to \"Yes\"\n            const cell = tableBodyRange.getCell(i, deletedIndex);\n            cell.setValue(\"Yes\");\n        }\n    }\n\n    // Clear form inputs \n    const rangesToClear: string[] = [\n        \"H5\",      // Product\n        \"H7:K7\",   // Description\n        \"H9\",      // UoM\n        \"K9\",      // Category\n        \"H11:I11\", // EAN\n        \"H15:I15\", // Supplier\n        \"H17\",     // Unit Price \n        \"K17\",     // Last Purchased\n        \"H21\",     // Qty On Hand\n        \"K21\",     // Stock Value\n        \"H23\",     // Stock Location\n        \"H25\",     // Reorder Point\n        \"K25\",     // Reorder Qty\n        \"H27:K27\"  // Notes\n    ];\n\n    for (let address of rangesToClear) {\n        try {\n            const range = formSheet.getRange(address);\n            range.clear(ExcelScript.ClearApplyTo.contents);\n        } catch (error) {\n            console.log(`Could not clear range ${address}: ${error}`);\n        }\n    }\n\n}","description":"","noCodeMetadata":"","parameterInfo":"{\"version\":1,\"originalParameterOrder\":[],\"parameterSchema\":{\"type\":\"object\",\"default\":{},\"x-ms-visibility\":\"internal\"},\"returnSchema\":{\"type\":\"object\",\"properties\":{}},\"signature\":{\"comment\":\"\",\"parameters\":[{\"name\":\"workbook\",\"comment\":\"\"}]}}","apiInfo":"{\"variant\":\"synchronous\",\"variantVersion\":2}"}