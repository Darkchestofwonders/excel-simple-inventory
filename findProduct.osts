{"version":"0.3.0","body":"function main(workbook: ExcelScript.Workbook) { \n    // Get the 'find' and 'detail' sheets \n    const findSheet = workbook.getWorksheet(\"Product Form\"); \n    const detailSheet = workbook.getWorksheet(\"Database & Calc\"); \n    \n    // Get product name from cell H5 \n    const prodName = findSheet.getRange(\"H5\").getValue() as string; \n    \n    // Clear form inputs safely (handles merged cells)\n    const rangesToClear: string[] = [\n        \"S5\",    // Movement Type\n        \"V5\",    // Value\n        \"Y5\",    // Date\n        \"S7\",    // PO\n        \"S9:V9\"  // Notes (merged cell)\n    ];\n\n    for (let address of rangesToClear) {\n        try {\n            const range = findSheet.getRange(address);\n            range.clear(ExcelScript.ClearApplyTo.contents);\n        } catch (error) {\n            console.log(`Could not clear range ${address}: ${error}`);\n        }\n    }\n\n    // Set Y5 to today's date \n    findSheet.getRange(\"Y5\").setFormulaLocal(\"=TODAY()\");\n    \n    // Get the 'custTable' table \n    const prodTable = detailSheet.getTable(\"ProductData\"); \n    const tableRows = prodTable.getRangeBetweenHeaderAndTotal().getValues(); \n    const headers = prodTable.getHeaderRowRange().getValues()[0]; \n    \n    // Get column indices \n    const productIndex = headers.indexOf(\"Product #\");\n    const descIndex = headers.indexOf(\"Description\");\n    const uomIndex = headers.indexOf(\"UoM\");\n    const categoryIndex = headers.indexOf(\"Category\");\n    const EANIndex = headers.indexOf(\"EAN\");\n    const supplierIndex = headers.indexOf(\"Supplier\");\n    const unitPriceIndex = headers.indexOf(\"Unit Price\");\n    const lastPurchasedndex = headers.indexOf(\"Last Purchased\"); \n    const qtyOnHandIndex = headers.indexOf(\"Qty on Hand\");\n    const stockValueIndex = headers.indexOf(\"Stock Value\");\n    const stockLocationIndex = headers.indexOf(\"Stock Location\");\n    const reorderPointIndex = headers.indexOf(\"Reorder Point\");\n    const reorderQtyIndex = headers.indexOf(\"Reorder Qty\");\n    const notesIndex = headers.indexOf(\"Notes\"); \n\n    \n    // Search for matching customer \n    let found = false; \n    for (let i = 0; i < tableRows.length; i++) { \n        const row = tableRows[i]; \n        if (row[productIndex]?.toString().toLowerCase() === prodName.toLowerCase()) { \n            findSheet.getRange(\"H7\").setValue(row[descIndex]); \n            findSheet.getRange(\"H9\").setValue(row[uomIndex]); \n            findSheet.getRange(\"K9\").setValue(row[categoryIndex]); \n            findSheet.getRange(\"H11\").setValue(row[EANIndex]); \n            findSheet.getRange(\"H15\").setValue(row[supplierIndex]); \n            findSheet.getRange(\"H17\").setValue(row[unitPriceIndex]); \n            findSheet.getRange(\"K17\").setValue(row[lastPurchasedndex]); \n            findSheet.getRange(\"H21\").setValue(row[qtyOnHandIndex]); \n            findSheet.getRange(\"K21\").setValue(row[stockValueIndex]); \n            findSheet.getRange(\"H23\").setValue(row[stockLocationIndex]); \n            findSheet.getRange(\"H25\").setValue(row[reorderPointIndex]); \n            findSheet.getRange(\"K25\").setValue(row[reorderQtyIndex]); \n            findSheet.getRange(\"H27\").setValue(row[notesIndex]); \n            found = true; \n            break; \n        }\n    } \n    \n    if (!found) {\n        const cellsToClear: string[] = [\"H5\", \"H7\"];\n        for (let i = 0; i < cellsToClear.length; i++) {\n            const cellRef: string = cellsToClear[i];\n            const range = findSheet.getRange(cellRef);\n            range.clear(ExcelScript.ClearApplyTo.contents);\n        }\n    }\n}","description":"","noCodeMetadata":"","parameterInfo":"{\"version\":1,\"originalParameterOrder\":[],\"parameterSchema\":{\"type\":\"object\",\"default\":{},\"x-ms-visibility\":\"internal\"},\"returnSchema\":{\"type\":\"object\",\"properties\":{}},\"signature\":{\"comment\":\"\",\"parameters\":[{\"name\":\"workbook\",\"comment\":\"\"}]}}","apiInfo":"{\"variant\":\"synchronous\",\"variantVersion\":2}"}